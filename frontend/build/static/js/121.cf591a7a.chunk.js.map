{"version":3,"file":"static/js/121.cf591a7a.chunk.js","mappings":"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","sources":["utils/crypto.ts","components/AddEmailAccount.tsx","pages/ManageAccounts.tsx"],"sourcesContent":["// src/utils/crypto.ts\r\nimport CryptoJS from 'crypto-js';\r\n\r\nconst STORAGE_KEY = 'user_email_accounts';\r\nconst SECRET = 'snapmail2026'; // ควรเปลี่ยนเป็น env ใน production\r\n\r\nexport function encryptAccounts(accounts: any[]): string {\r\n  const data = JSON.stringify(accounts);\r\n  return CryptoJS.AES.encrypt(data, SECRET).toString();\r\n}\r\n\r\nexport function decryptAccounts(ciphertext: string): any[] {\r\n  try {\r\n    const bytes = CryptoJS.AES.decrypt(ciphertext, SECRET);\r\n    const decrypted = bytes.toString(CryptoJS.enc.Utf8);\r\n    return JSON.parse(decrypted);\r\n  } catch {\r\n    return [];\r\n  }\r\n}\r\n\r\nexport function saveAccounts(accounts: any[]) {\r\n  localStorage.setItem(STORAGE_KEY, encryptAccounts(accounts));\r\n}\r\n\r\nexport function loadAccounts(): any[] {\r\n  const cipher = localStorage.getItem(STORAGE_KEY);\r\n  if (!cipher) return [];\r\n  return decryptAccounts(cipher);\r\n}\r\n","\r\nimport React, { useState } from 'react';\r\n\r\nconst AddEmailAccount: React.FC<{ onAdd: (acc: any) => void }> = ({ onAdd }) => {\r\n  const [cred, setCred] = useState('');\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  function validate() {\r\n    const sep = cred.includes('|') ? '|' : cred.includes(':') ? ':' : '|';\r\n    const parts = cred.split(sep);\r\n    if (parts.length < 4 || parts.length > 5) return 'รูปแบบต้องเป็น email|password|refresh_token|client_id หรือ email|password|refresh_token|client_id|client_secret (ใช้ | หรือ : ก็ได้)';\r\n    if (!parts[0].match(/^\\S+@\\S+\\.\\S+$/)) return 'กรุณากรอกอีเมลให้ถูกต้อง';\r\n    return null;\r\n  }\r\n\r\n  function handleAdd(e: React.FormEvent) {\r\n    e.preventDefault();\r\n    const err = validate();\r\n    if (err) return setError(err);\r\n    setError(null);\r\n    // Always store as string, let backend parse\r\n    onAdd(cred);\r\n    setCred('');\r\n  }\r\n\r\n  return (\r\n    <form onSubmit={handleAdd} className=\"bg-white border border-gray-200 rounded-xl shadow-sm p-6 max-w-xl mx-auto mb-6\">\r\n      <h2 className=\"text-lg font-bold mb-4\">เพิ่มบัญชีอีเมล</h2>\r\n      <div className=\"mb-4\">\r\n        <label className=\"block font-medium mb-1\">ข้อมูลบัญชี (email|password|refresh_token|client_id[|client_secret] หรือ email:password:refresh_token:client_id[:client_secret])</label>\r\n        <input\r\n          className=\"w-full border rounded px-3 py-2 font-mono\"\r\n          value={cred}\r\n          onChange={e => setCred(e.target.value)}\r\n          placeholder=\"user@email.com|password|refresh_token|client_id  หรือ  user@email.com:password:refresh_token:client_id\"\r\n          required\r\n        />\r\n      </div>\r\n      {error && <div className=\"text-red-500 mb-2\">{error}</div>}\r\n      <button type=\"submit\" className=\"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 rounded shadow\">เพิ่มบัญชี</button>\r\n    </form>\r\n  );\r\n};\r\n\r\n\r\nexport default AddEmailAccount;\r\n","import React from 'react';\r\nimport AddEmailAccount from '../components/AddEmailAccount';\r\nimport { loadAccounts, saveAccounts } from '../utils/crypto';\r\n\r\nconst ManageAccounts: React.FC = () => {\r\n  const [accounts, setAccounts] = React.useState<any[]>(() => loadAccounts());\r\n\r\n  function handleAddAccount(acc: any) {\r\n    const newAccounts = [...accounts, acc];\r\n    setAccounts(newAccounts);\r\n    saveAccounts(newAccounts);\r\n  }\r\n\r\n  function handleDeleteAccount(idx: number) {\r\n    const newAccounts = accounts.filter((_, i) => i !== idx);\r\n    setAccounts(newAccounts);\r\n    saveAccounts(newAccounts);\r\n  }\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto w-full px-4 py-6\">\r\n      <AddEmailAccount onAdd={handleAddAccount} />\r\n      {accounts.length > 0 && (\r\n        <div className=\"mb-8 bg-white border border-gray-200 rounded-xl shadow-sm p-6 max-w-xl mx-auto\">\r\n          <h3 className=\"font-bold mb-2\">บัญชีอีเมลที่เพิ่มไว้</h3>\r\n          <ul className=\"list-disc list-inside text-sm text-gray-700\">\r\n            {accounts.map((acc, i) => {\r\n              // acc is a string: email|password|refresh_token|client_id[|client_secret] or ... with :\r\n              const sep = acc.includes('|') ? '|' : acc.includes(':') ? ':' : '|';\r\n              const parts = acc.split(sep);\r\n              return (\r\n                <li key={i} className=\"flex items-center justify-between py-1\">\r\n                  <span>{parts[0]}</span>\r\n                  <button onClick={() => handleDeleteAccount(i)} className=\"ml-2 px-2 py-0.5 text-xs bg-red-100 text-red-600 rounded hover:bg-red-200\">ลบ</button>\r\n                </li>\r\n              );\r\n            })}\r\n          </ul>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ManageAccounts;\r\n"],"names":["STORAGE_KEY","SECRET","encryptAccounts","accounts","data","JSON","stringify","CryptoJS","encrypt","toString","decryptAccounts","ciphertext","decrypted","decrypt","Utf8","parse","_unused","saveAccounts","localStorage","setItem","loadAccounts","cipher","getItem","_ref","onAdd","cred","setCred","useState","error","setError","_jsxs","onSubmit","e","preventDefault","err","sep","includes","parts","split","length","match","validate","className","children","_jsx","value","onChange","target","placeholder","required","type","ManageAccounts","setAccounts","React","AddEmailAccount","acc","newAccounts","map","i","onClick","idx","filter","_","handleDeleteAccount"],"ignoreList":[],"sourceRoot":""}