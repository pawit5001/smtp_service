(self.webpackChunksmtp_email_sender_frontend=self.webpackChunksmtp_email_sender_frontend||[]).push([[983],{619(e,t,s){"use strict";s.r(t),s.d(t,{decryptAccounts:()=>i,encryptAccounts:()=>c,loadAccounts:()=>d,saveAccounts:()=>o});var a=s(8561),r=s.n(a);const l="user_email_accounts",n="snapmail2026";function c(e){const t=JSON.stringify(e);return r().AES.encrypt(t,n).toString()}function i(e){try{const t=r().AES.decrypt(e,n).toString(r().enc.Utf8);return JSON.parse(t)}catch(t){return[]}}function o(e){localStorage.setItem(l,c(e))}function d(){const e=localStorage.getItem(l);return e?i(e):[]}},3175(e,t,s){"use strict";s.r(t),s.d(t,{default:()=>c});var a=s(5043),r=s(579);const l=e=>{let{count:t=6}=e;return(0,r.jsx)("div",{className:"flex flex-col gap-2 animate-pulse",children:Array.from({length:t}).map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center gap-3 bg-gray-100 rounded-lg h-16 p-3",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-200"}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-2"}),(0,r.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/3"})]})]},t))})},n=()=>(0,r.jsxs)("div",{className:"p-6 animate-pulse",children:[(0,r.jsx)("div",{className:"h-6 bg-gray-200 rounded w-2/3 mb-4"}),(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/3 mb-2"}),(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/4 mb-6"}),(0,r.jsx)("div",{className:"space-y-2",children:Array.from({length:10}).map((e,t)=>(0,r.jsx)("div",{className:"h-3 bg-gray-200 rounded w-full"},t))})]}),c=()=>{const[e,t]=(0,a.useState)(()=>{try{const{loadAccounts:e}=s(619);return e()}catch(e){return[]}}),[c,i]=(0,a.useState)(0),[o,d]=(0,a.useState)(null),[x,m]=(0,a.useState)(!0),[u,h]=(0,a.useState)([]),[g,f]=(0,a.useState)(!1),[p,v]=(0,a.useState)(null),[b,y]=(0,a.useState)("imap"),[j,N]=(0,a.useState)(1),[w]=(0,a.useState)(10),[S,_]=(0,a.useState)(!0),A=(0,a.useRef)(null),[C,P]=(0,a.useState)("desc"),[k,O]=(0,a.useState)(null),[I,E]=(0,a.useState)(""),T=u.filter(e=>{var t,s,a;const r=I.toLowerCase();return(null===(t=e.subject)||void 0===t?void 0:t.toLowerCase().includes(r))||(null===(s=e.from)||void 0===s?void 0:s.toLowerCase().includes(r))||(null===(a=e.body_text)||void 0===a?void 0:a.toLowerCase().includes(r))});(0,a.useEffect)(()=>{h([]),N(1),_(!0)},[b,w,C,e,c,I]),(0,a.useEffect)(()=>{let t=!1;if("graph"===b)return h([]),v("\u0e02\u0e2d\u0e2d\u0e20\u0e31\u0e22 \u0e02\u0e13\u0e30\u0e19\u0e35\u0e49\u0e22\u0e31\u0e07\u0e44\u0e21\u0e48\u0e23\u0e2d\u0e07\u0e23\u0e31\u0e1a\u0e01\u0e32\u0e23\u0e2d\u0e48\u0e32\u0e19\u0e2d\u0e35\u0e40\u0e21\u0e25\u0e1c\u0e48\u0e32\u0e19 Microsoft Graph API \u0e40\u0e19\u0e37\u0e48\u0e2d\u0e07\u0e08\u0e32\u0e01 scope/\u0e2a\u0e34\u0e17\u0e18\u0e34\u0e4c\u0e02\u0e2d\u0e07\u0e41\u0e2d\u0e1b\u0e1e\u0e25\u0e34\u0e40\u0e04\u0e0a\u0e31\u0e19\u0e44\u0e21\u0e48\u0e44\u0e14\u0e49\u0e15\u0e23\u0e07\u0e01\u0e31\u0e1a\u0e17\u0e35\u0e48 Microsoft \u0e2d\u0e19\u0e38\u0e0d\u0e32\u0e15 \u0e01\u0e23\u0e38\u0e13\u0e32\u0e43\u0e0a\u0e49 IMAP/POP3 \u0e2a\u0e33\u0e2b\u0e23\u0e31\u0e1a\u0e01\u0e32\u0e23\u0e2d\u0e48\u0e32\u0e19\u0e2d\u0e35\u0e40\u0e21\u0e25"),f(!1),void _(!1);f(!0);const s={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_API_KEY:"pawit_snaptranslate"}.REACT_APP_API_URL||"http://localhost:8000",a=new URLSearchParams({sort:C,page:j.toString(),page_size:w.toString()});let r=null,l=null,n=!0;if(e.length>0&&e[c])if(r=e[c],r){const e=r.includes("|")?"|":r.includes(":")?":":"|";l=r.split(e)[0],n=!1}else l="xvrifkhiss3889@hotmail.com",n=!0;else l="xvrifkhiss3889@hotmail.com",n=!0;d(l),m(n);const i="readmail_cache_".concat(l,"_").concat(C,"_").concat(j,"_").concat(w,"_").concat(b),o=sessionStorage.getItem(i);if(o)try{const e=JSON.parse(o);return void(t||(h(t=>1===j?e.emails||[]:[...t,...e.emails||[]]),v(e.error||null),_(e.emails&&e.emails.length===w),f(!1)))}catch(x){}return(async()=>{try{let e;if(e=r?await fetch("".concat(s,"/read-emails?").concat(a.toString()),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat("pawit_snaptranslate")},body:JSON.stringify({credentials:r})}):await fetch("".concat(s,"/read-emails?").concat(a.toString()),{headers:{Authorization:"Bearer ".concat("pawit_snaptranslate")}}),e.ok){const s=await e.json();t||(h(e=>1===j?s.emails||[]:[...e,...s.emails||[]]),v(null),_(s.emails&&s.emails.length===w)),sessionStorage.setItem(i,JSON.stringify({emails:s.emails||[]}))}else{const s=await e.json();t||(v(s.detail||"Unknown error"),_(!1)),sessionStorage.setItem(i,JSON.stringify({emails:[],error:s.detail||"Unknown error"}))}}catch(e){t||(e instanceof Error?(v(e.message),_(!1),sessionStorage.setItem(i,JSON.stringify({emails:[],error:e.message}))):(v("An unknown error occurred."),_(!1),sessionStorage.setItem(i,JSON.stringify({emails:[],error:"An unknown error occurred."}))))}finally{t||f(!1)}})(),()=>{t=!0}},[b,j,w,C,e,c]);const L=(0,a.useCallback)(e=>{e[0].isIntersecting&&S&&!g&&N(e=>e+1)},[S,g]);return(0,a.useEffect)(()=>{const e=new window.IntersectionObserver(L,{root:null,rootMargin:"0px",threshold:.1});return A.current&&e.observe(A.current),()=>{A.current&&e.unobserve(A.current)}},[L]),(0,r.jsxs)("div",{className:"flex flex-col min-h-screen bg-gray-50",children:[(0,r.jsx)("div",{className:"max-w-4xl mx-auto w-full px-4 pt-4 pb-0",children:(0,r.jsxs)("div",{className:"mb-2 text-xs text-gray-600 bg-gray-100 border border-gray-200 rounded px-3 py-2",children:[(0,r.jsx)("span",{className:"font-semibold text-gray-800",children:"\u0e1a\u0e31\u0e0d\u0e0a\u0e35\u0e17\u0e35\u0e48\u0e43\u0e0a\u0e49\u0e43\u0e19\u0e01\u0e32\u0e23\u0e2d\u0e48\u0e32\u0e19\u0e40\u0e21\u0e25:"})," ",o," ",x&&(0,r.jsx)("span",{className:"text-gray-400",children:"(\u0e04\u0e48\u0e32\u0e40\u0e23\u0e34\u0e48\u0e21\u0e15\u0e49\u0e19)"}),e.length>1&&(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsx)("label",{className:"mr-2 font-medium",children:"\u0e40\u0e25\u0e37\u0e2d\u0e01\u0e1a\u0e31\u0e0d\u0e0a\u0e35:"}),(0,r.jsx)("select",{className:"border rounded px-2 py-1 text-sm",value:c,onChange:e=>{i(Number(e.target.value)),O(null),N(1)},title:"\u0e40\u0e25\u0e37\u0e2d\u0e01\u0e1a\u0e31\u0e0d\u0e0a\u0e35\u0e2d\u0e35\u0e40\u0e21\u0e25\u0e17\u0e35\u0e48\u0e43\u0e0a\u0e49\u0e43\u0e19\u0e01\u0e32\u0e23\u0e2d\u0e48\u0e32\u0e19","aria-label":"\u0e40\u0e25\u0e37\u0e2d\u0e01\u0e1a\u0e31\u0e0d\u0e0a\u0e35\u0e2d\u0e35\u0e40\u0e21\u0e25\u0e17\u0e35\u0e48\u0e43\u0e0a\u0e49\u0e43\u0e19\u0e01\u0e32\u0e23\u0e2d\u0e48\u0e32\u0e19",children:e.map((e,t)=>{const s=e.includes("|")?"|":e.includes(":")?":":"|",a=e.split(s)[0];return(0,r.jsx)("option",{value:t,children:a},t)})})]})]})}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col md:flex-row max-w-4xl mx-auto w-full px-4 py-6 gap-4",children:[(0,r.jsxs)("div",{className:"w-full md:w-1/3 md:max-w-xs bg-white border border-gray-200 rounded-xl shadow-sm p-4 flex flex-col",children:[(0,r.jsx)("h2",{className:"text-lg font-bold mb-2",children:"\u0e01\u0e25\u0e48\u0e2d\u0e07\u0e2d\u0e35\u0e40\u0e21\u0e25"}),(0,r.jsx)("div",{className:"mb-2",children:(0,r.jsx)("input",{type:"text",className:"w-full border rounded px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-400",placeholder:"\u0e04\u0e49\u0e19\u0e2b\u0e32\u0e2d\u0e35\u0e40\u0e21\u0e25 (\u0e2b\u0e31\u0e27\u0e02\u0e49\u0e2d, \u0e1c\u0e39\u0e49\u0e2a\u0e48\u0e07, \u0e02\u0e49\u0e2d\u0e04\u0e27\u0e32\u0e21)",value:I,onChange:e=>{E(e.target.value),O(null)},"aria-label":"\u0e04\u0e49\u0e19\u0e2b\u0e32\u0e2d\u0e35\u0e40\u0e21\u0e25"})}),(0,r.jsx)("div",{className:"mb-2 p-2 bg-blue-50 border border-blue-200 rounded text-blue-800 text-xs",children:"\u0e23\u0e30\u0e1a\u0e1a\u0e19\u0e35\u0e49\u0e23\u0e2d\u0e07\u0e23\u0e31\u0e1a\u0e01\u0e32\u0e23\u0e2d\u0e48\u0e32\u0e19\u0e2d\u0e35\u0e40\u0e21\u0e25\u0e1c\u0e48\u0e32\u0e19 IMAP/POP3 \u0e40\u0e17\u0e48\u0e32\u0e19\u0e31\u0e49\u0e19 (Microsoft Graph API \u0e22\u0e31\u0e07\u0e44\u0e21\u0e48\u0e23\u0e2d\u0e07\u0e23\u0e31\u0e1a\u0e01\u0e32\u0e23\u0e2d\u0e48\u0e32\u0e19\u0e2d\u0e35\u0e40\u0e21\u0e25 \u0e40\u0e19\u0e37\u0e48\u0e2d\u0e07\u0e08\u0e32\u0e01 scope/\u0e2a\u0e34\u0e17\u0e18\u0e34\u0e4c\u0e02\u0e2d\u0e07\u0e41\u0e2d\u0e1b\u0e1e\u0e25\u0e34\u0e40\u0e04\u0e0a\u0e31\u0e19\u0e44\u0e21\u0e48\u0e15\u0e23\u0e07\u0e01\u0e31\u0e1a\u0e17\u0e35\u0e48 Microsoft \u0e2d\u0e19\u0e38\u0e0d\u0e32\u0e15)"}),(0,r.jsxs)("div",{className:"mb-2 flex flex-wrap gap-2 items-center",children:[(0,r.jsx)("label",{className:"font-medium mr-2",children:"\u0e40\u0e23\u0e35\u0e22\u0e07\u0e25\u0e33\u0e14\u0e31\u0e1a:"}),(0,r.jsxs)("div",{className:"relative w-48",children:[(0,r.jsxs)("select",{className:"w-full border rounded px-3 py-2 pr-8 appearance-none focus:ring-2 focus:ring-blue-400 bg-white text-gray-700 shadow-sm hover:border-blue-400 transition",value:C,onChange:e=>{P(e.target.value),N(1)},"aria-label":"\u0e40\u0e23\u0e35\u0e22\u0e07\u0e25\u0e33\u0e14\u0e31\u0e1a\u0e2d\u0e35\u0e40\u0e21\u0e25",children:[(0,r.jsx)("option",{value:"desc",children:"\u0e43\u0e2b\u0e21\u0e48 \u2192 \u0e40\u0e01\u0e48\u0e32 (\u0e25\u0e48\u0e32\u0e2a\u0e38\u0e14\u0e01\u0e48\u0e2d\u0e19)"}),(0,r.jsx)("option",{value:"asc",children:"\u0e40\u0e01\u0e48\u0e32 \u2192 \u0e43\u0e2b\u0e21\u0e48 (\u0e40\u0e01\u0e48\u0e32\u0e2a\u0e38\u0e14\u0e01\u0e48\u0e2d\u0e19)"})]}),(0,r.jsx)("span",{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 flex items-center",children:(0,r.jsx)("svg",{className:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})})]})]}),(0,r.jsx)("div",{ref:A,style:{height:1}}),g&&(0,r.jsx)("div",{className:"text-center text-gray-400 text-xs mt-2",children:"\u0e01\u0e33\u0e25\u0e31\u0e07\u0e42\u0e2b\u0e25\u0e14\u0e2d\u0e35\u0e40\u0e21\u0e25..."}),!S&&!g&&(0,r.jsx)("div",{className:"text-center text-gray-400 text-xs mt-2",children:"\u0e44\u0e21\u0e48\u0e21\u0e35\u0e2d\u0e35\u0e40\u0e21\u0e25\u0e40\u0e1e\u0e34\u0e48\u0e21\u0e40\u0e15\u0e34\u0e21"}),p&&!g&&(0,r.jsx)("div",{className:"text-red-500 text-xs mb-2",children:p}),g?(0,r.jsxs)("div",{className:"flex flex-col gap-2 mt-8",children:[(0,r.jsx)(l,{count:6}),(0,r.jsx)("div",{className:"text-center text-gray-400 text-xs mt-2",children:"\u0e01\u0e33\u0e25\u0e31\u0e07\u0e42\u0e2b\u0e25\u0e14\u0e2d\u0e35\u0e40\u0e21\u0e25..."})]}):0===T.length?(0,r.jsx)("div",{className:"text-center text-gray-400 mt-8",children:"\u0e44\u0e21\u0e48\u0e1e\u0e1a\u0e2d\u0e35\u0e40\u0e21\u0e25"}):(0,r.jsx)("div",{className:"flex flex-col gap-2 overflow-y-auto max-h-[60vh]",children:T.map((e,t)=>(0,r.jsxs)("button",{className:"text-left transition-shadow bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md p-3 flex flex-col gap-1 ".concat(k===t?"ring-2 ring-blue-400 border-blue-300":""),onClick:()=>O(t),tabIndex:0,"aria-label":"\u0e14\u0e39\u0e2d\u0e35\u0e40\u0e21\u0e25\u0e2b\u0e31\u0e27\u0e02\u0e49\u0e2d ".concat(e.subject||"(\u0e44\u0e21\u0e48\u0e21\u0e35\u0e2b\u0e31\u0e27\u0e40\u0e23\u0e37\u0e48\u0e2d\u0e07)"),children:[(0,r.jsx)("div",{className:"font-semibold text-base truncate text-gray-900",children:e.subject||(0,r.jsx)("span",{className:"italic text-gray-400",children:"(\u0e44\u0e21\u0e48\u0e21\u0e35\u0e2b\u0e31\u0e27\u0e40\u0e23\u0e37\u0e48\u0e2d\u0e07)"})}),(0,r.jsxs)("div",{className:"text-xs text-gray-500 truncate",children:["\u0e08\u0e32\u0e01: ",e.from||(0,r.jsx)("span",{className:"italic text-gray-400",children:"(\u0e44\u0e21\u0e48\u0e23\u0e30\u0e1a\u0e38)"})]}),(0,r.jsx)("div",{className:"text-xs text-gray-400",children:e.date&&new Date(e.date).toLocaleString("th-TH",{dateStyle:"medium",timeStyle:"short"})})]},t))})]}),(0,r.jsx)("div",{className:"flex-1 bg-white border border-gray-200 rounded-xl shadow-sm p-6 ml-0 md:ml-4 min-h-[400px] flex flex-col",children:g?(0,r.jsxs)("div",{className:"flex-1 flex flex-col justify-center items-center",children:[(0,r.jsx)("div",{className:"text-gray-400 text-sm mb-4",children:"\u0e01\u0e33\u0e25\u0e31\u0e07\u0e42\u0e2b\u0e25\u0e14\u0e40\u0e19\u0e37\u0e49\u0e2d\u0e2b\u0e32\u0e2d\u0e35\u0e40\u0e21\u0e25..."}),(0,r.jsx)(n,{})]}):p?(0,r.jsx)("div",{className:"text-red-500 text-center my-auto",children:p}):0===u.length?(0,r.jsx)("div",{className:"text-center text-gray-400 my-auto",children:"\u0e44\u0e21\u0e48\u0e1e\u0e1a\u0e2d\u0e35\u0e40\u0e21\u0e25"}):null===k?(0,r.jsx)("div",{className:"text-center text-gray-400 my-auto",children:"\u0e40\u0e25\u0e37\u0e2d\u0e01\u0e2d\u0e35\u0e40\u0e21\u0e25\u0e08\u0e32\u0e01\u0e23\u0e32\u0e22\u0e01\u0e32\u0e23\u0e17\u0e32\u0e07\u0e0b\u0e49\u0e32\u0e22\u0e40\u0e1e\u0e37\u0e48\u0e2d\u0e14\u0e39\u0e40\u0e19\u0e37\u0e49\u0e2d\u0e2b\u0e32"}):(()=>{const e=null!==k?u[k]:void 0;return e?(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsxs)("div",{className:"mb-2",children:[(0,r.jsx)("div",{className:"text-lg font-bold text-gray-900",children:e.subject||(0,r.jsx)("span",{className:"italic text-gray-400",children:"(\u0e44\u0e21\u0e48\u0e21\u0e35\u0e2b\u0e31\u0e27\u0e40\u0e23\u0e37\u0e48\u0e2d\u0e07)"})}),(0,r.jsxs)("div",{className:"text-xs text-gray-500",children:["\u0e08\u0e32\u0e01: ",e.from||(0,r.jsx)("span",{className:"italic text-gray-400",children:"(\u0e44\u0e21\u0e48\u0e23\u0e30\u0e1a\u0e38)"})]}),(0,r.jsx)("div",{className:"text-xs text-gray-400",children:e.date&&new Date(e.date).toLocaleString("th-TH",{dateStyle:"medium",timeStyle:"short"})})]}),(0,r.jsx)("div",{className:"text-sm text-gray-700 whitespace-pre-line break-words overflow-x-auto min-h-[120px]",children:e.body_text?e.body_text:(0,r.jsx)("span",{className:"italic text-gray-400",children:"(\u0e44\u0e21\u0e48\u0e21\u0e35\u0e40\u0e19\u0e37\u0e49\u0e2d\u0e2b\u0e32)"})}),e.attachments&&e.attachments.length>0?(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("div",{className:"font-medium text-gray-700 mb-1",children:"\u0e44\u0e1f\u0e25\u0e4c\u0e41\u0e19\u0e1a:"}),(0,r.jsx)("ul",{className:"list-disc list-inside text-xs text-gray-600",children:e.attachments.map((e,t)=>(0,r.jsxs)("li",{children:[e.filename," ",(0,r.jsxs)("span",{className:"text-gray-400",children:["(",e.size," bytes)"]})]},t))})]}):null]}):null})()})]})]})}},6305(){}}]);
//# sourceMappingURL=983.06ce7f8e.chunk.js.map