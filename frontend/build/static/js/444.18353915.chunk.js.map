{"version":3,"file":"static/js/444.18353915.chunk.js","mappings":"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","sources":["utils/crypto.ts","components/MessageForm.tsx","pages/Home.tsx"],"sourcesContent":["// src/utils/crypto.ts\r\nimport CryptoJS from 'crypto-js';\r\n\r\nconst STORAGE_KEY = 'user_email_accounts';\r\nconst SECRET = 'snapmail2026';\r\n\r\nexport function encryptAccounts(accounts: any[]): string {\r\n  const data = JSON.stringify(accounts);\r\n  return CryptoJS.AES.encrypt(data, SECRET).toString();\r\n}\r\n\r\nexport function decryptAccounts(ciphertext: string): any[] {\r\n  try {\r\n    const bytes = CryptoJS.AES.decrypt(ciphertext, SECRET);\r\n    const decrypted = bytes.toString(CryptoJS.enc.Utf8);\r\n    return JSON.parse(decrypted);\r\n  } catch {\r\n    return [];\r\n  }\r\n}\r\n\r\nexport function saveAccounts(accounts: any[]) {\r\n  localStorage.setItem(STORAGE_KEY, encryptAccounts(accounts));\r\n}\r\n\r\nexport function loadAccounts(): any[] {\r\n  const cipher = localStorage.getItem(STORAGE_KEY);\r\n  if (!cipher) return [];\r\n  return decryptAccounts(cipher);\r\n}\r\n","import React, { useState, useRef } from 'react';\r\nimport { toast } from 'react-toastify';\r\n\r\n\r\nconst MessageForm: React.FC = () => {\r\n        // Multi-account selection (load from local storage or crypto utils)\r\n        // Preload default accounts (CREDS_SMTP, CREDS_GRAPH_API) if not present\r\n        const DEFAULT_ACCOUNTS = [\r\n            // Format: email|password|refresh_token|client_id|client_secret (or : as separator)\r\n            // These should match the backend hardcoded credentials\r\n            \"scavelli20322@outlook.com:E9KFDQHK72:M.C525_BAY.0.U.-Cr2ahYnR0lKDamU!PsNLhZjitfSxG5nWVXX*e80FlN2v7ds8KjPnQJS49uWLNeSjm28StMZzxrMDkZcG!VCOEbLQPoAL47VUKF5LArrGFFumN1EEIdrJGgTsic31r3jgjWD9M6APy13ZA*Z!acADB0!UTuGWd9EDoX8fzHXz6pMRv7N25!UnxpP6xAVIkAiMO3Oc8y2qxUmXn*9H85yR6rzKHFxAfmJjVtR3QXkWrFo8svzckWd!1xEmQFuCpJf5yTqJT9HTPERq1WSTWSpuuKo4P*U9k3MMP5IbGbzf1q77GeNa3zEOBf0V6RBRH04N!JViKhoYPHg66SMg1pEcC35!ykJOdFDP5B87SRO3ue3JwMNC2BYvKSnvLzLvTOsdK140o8uwMKOTz01OGSHG7pnCKcQvWlyVw9RAFvdRkkcG2Utm9bL0JLMSZFZlpnKyo*Pm9EuZwpMI33ARhKQsYA4$:9e5f94bc-e8a4-4e73-b8be-63364c29d753\",\r\n            \"xvrifkhiss3889@hotmail.com|btkulnpgqc6633|M.C514_BAY.0.U.-CtJ7GCOdTQTBpb9P4kmJIg21RM72jCtBfhs0UTewbfrvLjb5Qi63vsnpSQoMrDnZmQ1M7wBZS2JdvFMM5xFmj2xcqDA6adQ6Qj3voyxcA!m8OzrSYOO4gn0KQkfeaoBBTIDAJxtrDy3CZy99MaoXzOqud8Iw22Pivbe0!G1vUXlDtOouwHAkuHCk!ErR8i5JRWZgpjKlKyCl18uubG*4HMoRo2yEo1cSnkHjImCRNa2GQ5SaVrMLTK8OUZTdHxaSau8zaejKaDXIdMXvjpXSW6KZxY9tHfIG1ANpb0o!2SFSsYmPyZQ59E8gjxlJYFe564wXlobB00G6TUO9f9Qzys5NEOPl5zx28vGMgP6alrIcA1HrX!ZpQIu3NbfmzWvGk1izNpFWpdbZyP0Z4sSiJmf6NMaN1bog5E9zxdZI9Y5y|9e5f94bc-e8a4-4e73-b8be-63364c29d753\"\r\n        ];\r\n        const [accounts, setAccounts] = useState<any[]>(() => {\r\n            try {\r\n                const { loadAccounts } = require('../utils/crypto');\r\n                let loaded = loadAccounts();\r\n                // Add default accounts if not present\r\n                DEFAULT_ACCOUNTS.forEach(def => {\r\n                    const defEmail = def.split(/[|:]/)[0];\r\n                    if (!loaded.some((acc: string) => acc.split(/[|:]/)[0] === defEmail)) {\r\n                        loaded.push(def);\r\n                    }\r\n                });\r\n                // Sort: default accounts (alphabetically) on top, then others alphabetically\r\n                loaded.sort((a: string, b: string) => {\r\n                    const emailA = a.split(/[|:]/)[0];\r\n                    const emailB = b.split(/[|:]/)[0];\r\n                    const isDefA = [\"scavelli20322@outlook.com\", \"xvrifkhiss3889@hotmail.com\"].includes(emailA);\r\n                    const isDefB = [\"scavelli20322@outlook.com\", \"xvrifkhiss3889@hotmail.com\"].includes(emailB);\r\n                    if (isDefA && isDefB) return emailA.localeCompare(emailB);\r\n                    if (isDefA && !isDefB) return -1;\r\n                    if (!isDefA && isDefB) return 1;\r\n                    return emailA.localeCompare(emailB);\r\n                });\r\n                return loaded;\r\n            } catch {\r\n                return [...DEFAULT_ACCOUNTS].sort((a: string, b: string) => {\r\n                    const emailA = a.split(/[|:]/)[0];\r\n                    const emailB = b.split(/[|:]/)[0];\r\n                    const isDefA = [\"scavelli20322@outlook.com\", \"xvrifkhiss3889@hotmail.com\"].includes(emailA);\r\n                    const isDefB = [\"scavelli20322@outlook.com\", \"xvrifkhiss3889@hotmail.com\"].includes(emailB);\r\n                    if (isDefA && isDefB) return emailA.localeCompare(emailB);\r\n                    if (isDefA && !isDefB) return -1;\r\n                    if (!isDefA && isDefB) return 1;\r\n                    return emailA.localeCompare(emailB);\r\n                });\r\n            }\r\n        });\r\n    // ...existing code...\r\n    // Persist selected account index in localStorage\r\n    const ACCOUNT_IDX_KEY = 'messageform_selected_account_idx';\r\n    const getDefaultAccountIdx = (accounts: string[]) => {\r\n        const saved = localStorage.getItem(ACCOUNT_IDX_KEY);\r\n        if (saved && !isNaN(Number(saved)) && accounts[Number(saved)]) return Number(saved);\r\n        return Math.max(0, accounts.findIndex((acc: string) => acc.split(/[|:]/)[0] === \"scavelli20322@outlook.com\"));\r\n    };\r\n    const [selectedAccountIdx, setSelectedAccountIdx] = useState(() => getDefaultAccountIdx(\r\n        (() => {\r\n            try {\r\n                const { loadAccounts } = require('../utils/crypto');\r\n                let loaded = loadAccounts();\r\n                DEFAULT_ACCOUNTS.forEach(def => {\r\n                    const defEmail = def.split(/[|:]/)[0];\r\n                    if (!loaded.some((acc: string) => acc.split(/[|:]/)[0] === defEmail)) {\r\n                        loaded.push(def);\r\n                    }\r\n                });\r\n                return loaded;\r\n            } catch {\r\n                return [...DEFAULT_ACCOUNTS];\r\n            }\r\n        })()\r\n    ));\r\n    // Save to localStorage when changed\r\n    React.useEffect(() => {\r\n        localStorage.setItem(ACCOUNT_IDX_KEY, String(selectedAccountIdx));\r\n    }, [selectedAccountIdx]);\r\n    let activeEmail = 'xvrifkhiss3889@hotmail.com';\r\n    let isDefault = true;\r\n    if (accounts.length > 0 && accounts[selectedAccountIdx]) {\r\n        const sep = accounts[selectedAccountIdx].includes('|') ? '|' : accounts[selectedAccountIdx].includes(':') ? ':' : '|';\r\n        activeEmail = accounts[selectedAccountIdx].split(sep)[0];\r\n        isDefault = false;\r\n    }\r\n    // Cache/load form values from localStorage\r\n    const LS_KEY = 'message_form_cache';\r\n    const getCache = () => {\r\n        try {\r\n            return JSON.parse(localStorage.getItem(LS_KEY) || '{}');\r\n        } catch { return {}; }\r\n    };\r\n    const cache = getCache();\r\n    const [recipient, setRecipient] = useState(cache.recipient || '');\r\n    const [cc, setCc] = useState(cache.cc || '');\r\n    const [subject, setSubject] = useState(cache.subject || '');\r\n    const [body, setBody] = useState(cache.body || '');\r\n    const [loading, setLoading] = useState(false);\r\n    const [displayName, setDisplayName] = useState(cache.displayName || 'admin_snaptranslate');\r\n    const [sendMethod, setSendMethod] = useState<'graphapi' | 'smtp'>(cache.sendMethod || 'graphapi');\r\n    const [files, setFiles] = useState<FileList | null>(null);\r\n    const fileInputRef = useRef<HTMLInputElement | null>(null);\r\n    // Update localStorage every time form changes\r\n    React.useEffect(() => {\r\n        localStorage.setItem(LS_KEY, JSON.stringify({ recipient, cc, subject, body, displayName, sendMethod }));\r\n    }, [recipient, cc, subject, body, displayName, sendMethod]);\r\n    // Show warning if Graph API is selected\r\n    const isGraphApi = sendMethod === 'graphapi';\r\n    // Email validation and splitting helpers\r\n    const validateEmail = (email: string) => {\r\n        return /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email);\r\n    };\r\n    const getRecipientList = (): string[] => recipient.split(',').map((e: string) => e.trim()).filter(Boolean);\r\n    const getCcList = (): string[] => cc.split(',').map((e: string) => e.trim()).filter(Boolean);\r\n    // Handle form submit: validate, build FormData, send to backend\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        const recipients = getRecipientList();\r\n        const ccList = getCcList();\r\n        if (recipients.length === 0) {\r\n            toast.error('กรุณากรอกอีเมลผู้รับอย่างน้อย 1 คน');\r\n            return;\r\n        }\r\n        const invalids = recipients.filter((r: string) => !validateEmail(r)).concat(ccList.filter((r: string) => !validateEmail(r)));\r\n        if (invalids.length > 0) {\r\n            toast.error('อีเมลไม่ถูกต้อง: ' + invalids.join(', '));\r\n            return;\r\n        }\r\n        setLoading(true);\r\n        try {\r\n            // ...existing code...\r\n            let apiUrl = process.env.REACT_APP_API_URL || '';\r\n            if (!apiUrl) {\r\n                if (window.location.hostname === '127.0.0.1') {\r\n                    apiUrl = 'http://127.0.0.1:8000';\r\n                } else {\r\n                    apiUrl = 'http://localhost:8000';\r\n                }\r\n            }\r\n            const userCred = accounts.length > 0 && accounts[selectedAccountIdx] ? accounts[selectedAccountIdx] : null;\r\n            let res, data;\r\n            // Always send as FormData for file/multi-value support\r\n            const formData = new FormData();\r\n            recipients.forEach((r: string) => formData.append('recipient', r));\r\n            ccList.forEach((r: string) => formData.append('cc', r));\r\n            formData.append('subject', subject);\r\n            formData.append('body', body);\r\n            formData.append('display_name', displayName);\r\n            formData.append('send_method', sendMethod);\r\n            if (userCred) formData.append('credentials', userCred);\r\n            if (files && files.length > 0) {\r\n                for (let i = 0; i < files.length; i++) {\r\n                    formData.append('attachments', files[i]);\r\n                }\r\n            }\r\n            // Add timeout (30s)\r\n            const controller = new AbortController();\r\n            const timeoutId = setTimeout(() => controller.abort(), 30000);\r\n            try {\r\n                res = await fetch(`${apiUrl}/send-email/`, {\r\n                    method: 'POST',\r\n                    headers: {\r\n                        'Authorization': `Bearer ${process.env.REACT_APP_API_KEY || 'pawit_snaptranslate'}`\r\n                    },\r\n                    body: formData,\r\n                    signal: controller.signal\r\n                });\r\n            } catch (err) {\r\n                if (err && typeof err === 'object' && (err as any).name === 'AbortError') {\r\n                    toast.error('การส่งอีเมลใช้เวลานานเกินไป (timeout) กรุณาลองใหม่หรือตรวจสอบเซิร์ฟเวอร์');\r\n                    setLoading(false);\r\n                    clearTimeout(timeoutId);\r\n                    return;\r\n                } else {\r\n                    throw err;\r\n                }\r\n            }\r\n            clearTimeout(timeoutId);\r\n            data = await res.json();\r\n            if (res.ok && data.results) {\r\n                let successCount = 0;\r\n                let failCount = 0;\r\n                let failList: string[] = [];\r\n                data.results.forEach((r: any) => {\r\n                    if (r.success) {\r\n                        successCount++;\r\n                    } else {\r\n                        failCount++;\r\n                        failList.push(r.recipient);\r\n                    }\r\n                });\r\n                if (successCount > 0) {\r\n                    toast.success(`ส่งอีเมลสำเร็จ ${successCount} รายการ`);\r\n                    setRecipient('');\r\n                    setCc('');\r\n                    setSubject('');\r\n                    setBody('');\r\n                    setFiles(null);\r\n                    if (fileInputRef.current) fileInputRef.current.value = '';\r\n                    // Clear form cache after success\r\n                    localStorage.removeItem(LS_KEY);\r\n                }\r\n                if (failCount > 0) {\r\n                    // If all failed and using SMTP, suggest using Graph API\r\n                    if (failCount === data.results.length && sendMethod === 'smtp') {\r\n                        toast.error(`ส่งอีเมลไม่สำเร็จเลย อาจเกิดจาก Cloud หรือโฮสต์บล็อก SMTP แนะนำให้เปลี่ยนไปใช้โหมด Microsoft Graph API แล้วลองใหม่อีกครั้ง`);\r\n                    } else {\r\n                        toast.error(`ส่งอีเมลไม่สำเร็จ ${failCount} รายการ: ${failList.join(', ')}`);\r\n                    }\r\n                }\r\n            } else {\r\n                // ...existing code...\r\n                if (data && data.detail && typeof data.detail === 'string' && data.detail.includes('invalid_grant')) {\r\n                    toast.error('Token หมดอายุหรือสิทธิ์ไม่ถูกต้อง กรุณาเพิ่มบัญชีใหม่หรือ authorize ใหม่ใน Microsoft Azure Portal');\r\n                } else if (data && data.detail && typeof data.detail === 'string' && data.detail.includes('AADSTS70000')) {\r\n                    toast.error('Microsoft OAuth2: สิทธิ์ (scope) ไม่ถูกต้องหรือหมดอายุ กรุณา authorize ใหม่ใน Microsoft Azure Portal');\r\n                } else if (sendMethod === 'smtp' && res.ok && (!data.results || data.detail)) {\r\n                    toast.error('ส่งอีเมลไม่สำเร็จ อาจเกิดจาก Cloud หรือโฮสต์บล็อก SMTP แนะนำให้เปลี่ยนไปใช้โหมด Microsoft Graph API แล้วลองใหม่อีกครั้ง');\r\n                } else {\r\n                    toast.error(data.detail || 'เกิดข้อผิดพลาดในการส่งอีเมล');\r\n                }\r\n            }\r\n        } catch (err) {\r\n            if (err && typeof err === 'object' && (err as any).name === 'AbortError') {\r\n                // Already handled above\r\n            } else {\r\n                toast.error('เกิดข้อผิดพลาดที่ไม่คาดคิด กรุณาลองใหม่หรือติดต่อผู้ดูแลระบบ');\r\n            }\r\n        }\r\n        setLoading(false);\r\n    };\r\n    return (\r\n        <React.Fragment>\r\n            <form\r\n                className=\"w-full max-w-2xl mx-auto bg-white dark:bg-gray-900 rounded-xl shadow-md p-4 sm:p-6 flex flex-col gap-4 md:gap-6 lg:gap-8\"\r\n                onSubmit={handleSubmit}\r\n            >\r\n                <div className=\"mb-2\">\r\n                    <label className=\"block text-sm md:text-base font-medium text-gray-700 dark:text-gray-200 mb-1\">ส่งจากบัญชี</label>\r\n                    <div className=\"flex flex-col sm:flex-row sm:items-center gap-2\">\r\n                        <span className=\"text-gray-800 dark:text-gray-100 font-semibold text-sm md:text-base\">\r\n                            {activeEmail}\r\n                            {[\r\n                                \"scavelli20322@outlook.com\",\r\n                                \"xvrifkhiss3889@hotmail.com\"\r\n                            ].includes(activeEmail) && (\r\n                                <span className=\"text-blue-500 font-normal text-xs ml-1\">(ค่าเริ่มต้น)</span>\r\n                            )}\r\n                        </span>\r\n                        <select\r\n                            className=\"sm:ml-2 border rounded px-2 py-1 text-sm md:text-base bg-white dark:bg-gray-800 dark:text-gray-100 border-gray-300 dark:border-gray-700 w-full sm:w-auto\"\r\n                            value={selectedAccountIdx}\r\n                            onChange={e => setSelectedAccountIdx(Number(e.target.value))}\r\n                            title=\"เลือกบัญชีอีเมลที่ต้องการส่ง\"\r\n                        >\r\n                            {accounts.map((acc, i) => {\r\n                                const sep = acc.includes('|') ? '|' : acc.includes(':') ? ':' : '|';\r\n                                const email = acc.split(sep)[0];\r\n                                const isDef = [\"scavelli20322@outlook.com\", \"xvrifkhiss3889@hotmail.com\"].includes(email);\r\n                                return <option value={i} key={i}>{email}{isDef ? ' (ค่าเริ่มต้น)' : ''}</option>;\r\n                            })}\r\n                        </select>\r\n                    </div>\r\n                </div>\r\n                <div>\r\n                    <label className=\"block text-sm md:text-base font-medium text-gray-700 dark:text-gray-200 mb-1\">ชื่อผู้ส่ง (Display Name) <span className=\"text-gray-400 dark:text-gray-500\">(ไม่บังคับ)</span></label>\r\n                    <input\r\n                        type=\"text\"\r\n                        className=\"w-full border rounded px-3 py-2 text-sm md:text-base bg-white dark:bg-gray-800 dark:text-gray-100 border-gray-300 dark:border-gray-700\"\r\n                        value={displayName}\r\n                        onChange={e => setDisplayName(e.target.value)}\r\n                        placeholder=\"ชื่อที่จะแสดงในอีเมลผู้รับ\"\r\n                        title=\"ชื่อที่จะแสดงในอีเมลผู้รับ\"\r\n                        disabled={isGraphApi}\r\n                    />\r\n                    {isGraphApi && (\r\n                        <div className=\"text-xs text-yellow-600 mt-1\">* Microsoft Graph API ไม่รองรับการเปลี่ยน Display Name (จะใช้ชื่อบัญชี Microsoft เท่านั้น)</div>\r\n                    )}\r\n                </div>\r\n                <div>\r\n                    <label className=\"block text-sm md:text-base font-medium text-gray-700 dark:text-gray-200 mb-1\">อีเมลผู้รับ <span className=\"text-red-500\">*</span></label>\r\n                    <input\r\n                        type=\"text\"\r\n                        className=\"w-full border rounded px-3 py-2 text-sm md:text-base bg-white dark:bg-gray-800 dark:text-gray-100 border-gray-300 dark:border-gray-700\"\r\n                        value={recipient}\r\n                        onChange={e => setRecipient(e.target.value)}\r\n                        placeholder=\"ex: a@email.com, b@email.com, c@email.com\"\r\n                        title=\"กรอกอีเมลผู้รับหลายคนคั่นด้วย , (comma)\"\r\n                        required\r\n                    />\r\n                    <div className=\"text-xs md:text-sm text-gray-500 mt-1\">\r\n                        * ส่งอีเมลถึงผู้รับหลายคนคั่นด้วย , (comma)\r\n                        <div className=\"mt-1 px-2 py-1 bg-yellow-50 border border-yellow-300 rounded text-yellow-700\">\r\n                            <span className=\"font-semibold\">ตัวอย่าง:</span> a@email.com, b@email.com, c@email.com\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div>\r\n                    <label className=\"block text-sm md:text-base font-medium text-gray-700 dark:text-gray-200 mb-1\">CC (สำเนาถึง) <span className=\"text-gray-400 dark:text-gray-500\">(ไม่บังคับ)</span></label>\r\n                    <input\r\n                        type=\"text\"\r\n                        className=\"w-full border rounded px-3 py-2 text-sm md:text-base bg-white dark:bg-gray-800 dark:text-gray-100 border-gray-300 dark:border-gray-700\"\r\n                        value={cc}\r\n                        onChange={e => setCc(e.target.value)}\r\n                        placeholder=\"ex: cc1@email.com, cc2@email.com\"\r\n                        title=\"กรอกอีเมล CC หลายคนคั่นด้วย , (comma)\"\r\n                    />\r\n                    <div className=\"text-xs md:text-sm text-gray-500 mt-1\">\r\n                        * ส่งสำเนาถึงหลายคนคั่นด้วย , (comma)\r\n                        <div className=\"mt-1 px-2 py-1 bg-yellow-50 border border-yellow-300 rounded text-yellow-700\">\r\n                            <span className=\"font-semibold\">ตัวอย่าง:</span> cc1@email.com, cc2@email.com\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div>\r\n                    <label className=\"block text-sm md:text-base font-medium text-gray-700 dark:text-gray-200 mb-1\">หัวข้อ <span className=\"text-red-500\">*</span></label>\r\n                    <input\r\n                        type=\"text\"\r\n                        className=\"w-full border rounded px-3 py-2 text-sm md:text-base bg-white dark:bg-gray-800 dark:text-gray-100 border-gray-300 dark:border-gray-700\"\r\n                        value={subject}\r\n                        onChange={e => setSubject(e.target.value)}\r\n                        placeholder=\"หัวข้ออีเมล\"\r\n                        title=\"หัวข้ออีเมล\"\r\n                        required\r\n                    />\r\n                </div>\r\n                <div>\r\n                    <label className=\"block text-sm md:text-base font-medium text-gray-700 dark:text-gray-200 mb-1\">เนื้อหา <span className=\"text-red-500\">*</span></label>\r\n                    <textarea\r\n                        className=\"w-full border rounded px-3 py-2 text-sm md:text-base min-h-[120px] bg-white dark:bg-gray-800 dark:text-gray-100 border-gray-300 dark:border-gray-700\"\r\n                        value={body}\r\n                        onChange={e => setBody(e.target.value)}\r\n                        placeholder=\"พิมพ์ข้อความ...\"\r\n                        title=\"เนื้อหาอีเมล\"\r\n                        required\r\n                    />\r\n                </div>\r\n                <div>\r\n                    <label className=\"block text-sm md:text-base font-medium text-gray-700 dark:text-gray-200 mb-1\">แนบไฟล์ (ถ้ามี) <span className=\"text-gray-400 dark:text-gray-500\">(ไม่บังคับ)</span></label>\r\n                    <input\r\n                        type=\"file\"\r\n                        className=\"w-full border rounded px-3 py-2 text-sm md:text-base bg-white dark:bg-gray-800 dark:text-gray-100 border-gray-300 dark:border-gray-700\"\r\n                        multiple\r\n                        onChange={e => setFiles(e.target.files)}\r\n                        title=\"เลือกไฟล์แนบ\"\r\n                        ref={fileInputRef}\r\n                    />\r\n                </div>\r\n                <div className=\"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4\">\r\n                    <label className=\"font-medium dark:text-gray-200 text-sm md:text-base\" htmlFor=\"send-method-select\">วิธีส่ง:</label>\r\n                    <select\r\n                        id=\"send-method-select\"\r\n                        className=\"border rounded px-2 py-1 text-sm md:text-base bg-white dark:bg-gray-800 dark:text-gray-100 border-gray-300 dark:border-gray-700 w-full sm:w-auto\"\r\n                        value={sendMethod}\r\n                        onChange={e => setSendMethod(e.target.value as 'graphapi' | 'smtp')}\r\n                        title=\"เลือกวิธีการส่งอีเมล\"\r\n                    >\r\n                        <option value=\"graphapi\">Microsoft Graph API</option>\r\n                        <option value=\"smtp\">SMTP</option>\r\n                    </select>\r\n                </div>\r\n                <button\r\n                    type=\"submit\"\r\n                    className=\"bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 md:px-6 rounded shadow disabled:opacity-50 flex items-center justify-center gap-2 text-base md:text-lg\"\r\n                    disabled={loading}\r\n                >\r\n                    {loading && (\r\n                        <svg className=\"animate-spin h-5 w-5 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n                            <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\r\n                            <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z\"></path>\r\n                        </svg>\r\n                    )}\r\n                    {loading ? 'กำลังส่ง...' : 'ส่งอีเมล'}\r\n                </button>\r\n            </form>\r\n        </React.Fragment>\r\n    );\r\n}\r\n\r\nexport default MessageForm;","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport MessageForm from '../components/MessageForm';\n\nconst Home: React.FC = () => {\n    return (\n        <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50 dark:bg-gray-900\">\n            <div className=\"w-full max-w-4xl px-4 py-6\">\n                <MessageForm />\n            </div>\n        </div>\n    );\n};\n\nexport default Home;"],"names":["STORAGE_KEY","SECRET","encryptAccounts","accounts","data","JSON","stringify","CryptoJS","encrypt","toString","decryptAccounts","ciphertext","decrypted","decrypt","Utf8","parse","_unused","saveAccounts","localStorage","setItem","loadAccounts","cipher","getItem","MessageForm","DEFAULT_ACCOUNTS","setAccounts","useState","require","loaded","forEach","def","defEmail","split","some","acc","push","sort","a","b","emailA","emailB","isDefA","includes","isDefB","localeCompare","ACCOUNT_IDX_KEY","selectedAccountIdx","setSelectedAccountIdx","saved","isNaN","Number","Math","max","findIndex","getDefaultAccountIdx","_unused2","React","String","activeEmail","isDefault","length","sep","LS_KEY","cache","getCache","_unused3","recipient","setRecipient","cc","setCc","subject","setSubject","body","setBody","loading","setLoading","displayName","setDisplayName","sendMethod","setSendMethod","files","setFiles","fileInputRef","useRef","isGraphApi","validateEmail","email","test","_jsx","children","_jsxs","className","onSubmit","async","e","preventDefault","recipients","map","trim","filter","Boolean","ccList","toast","error","invalids","r","concat","join","apiUrl","process","window","location","hostname","userCred","res","formData","FormData","append","i","controller","AbortController","timeoutId","setTimeout","abort","fetch","method","headers","signal","err","name","clearTimeout","json","ok","results","successCount","failCount","failList","success","current","value","removeItem","detail","onChange","target","title","isDef","type","placeholder","disabled","required","multiple","ref","htmlFor","id","xmlns","fill","viewBox","cx","cy","stroke","strokeWidth","d","Home"],"ignoreList":[],"sourceRoot":""}