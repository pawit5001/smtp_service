{"version":3,"file":"static/js/444.e000e003.chunk.js","mappings":"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","sources":["utils/crypto.ts","components/MessageForm.tsx","pages/Home.tsx"],"sourcesContent":["// src/utils/crypto.ts\r\nimport CryptoJS from 'crypto-js';\r\n\r\nconst STORAGE_KEY = 'user_email_accounts';\r\nconst SECRET = 'snapmail2026';\r\n\r\nexport function encryptAccounts(accounts: any[]): string {\r\n  const data = JSON.stringify(accounts);\r\n  return CryptoJS.AES.encrypt(data, SECRET).toString();\r\n}\r\n\r\nexport function decryptAccounts(ciphertext: string): any[] {\r\n  try {\r\n    const bytes = CryptoJS.AES.decrypt(ciphertext, SECRET);\r\n    const decrypted = bytes.toString(CryptoJS.enc.Utf8);\r\n    return JSON.parse(decrypted);\r\n  } catch {\r\n    return [];\r\n  }\r\n}\r\n\r\nexport function saveAccounts(accounts: any[]) {\r\n  localStorage.setItem(STORAGE_KEY, encryptAccounts(accounts));\r\n}\r\n\r\nexport function loadAccounts(): any[] {\r\n  const cipher = localStorage.getItem(STORAGE_KEY);\r\n  if (!cipher) return [];\r\n  return decryptAccounts(cipher);\r\n}\r\n","import React, { useState } from 'react';\nimport { toast } from 'react-toastify';\n\n\nconst MessageForm: React.FC = () => {\n        // Multi-account selection (load from local storage or crypto utils)\n        // Preload default accounts (CREDS_SMTP, CREDS_GRAPH_API) if not present\n        const DEFAULT_ACCOUNTS = [\n            // Format: email|password|refresh_token|client_id|client_secret (or : as separator)\n            // These should match the backend hardcoded credentials\n            \"scavelli20322@outlook.com:E9KFDQHK72:M.C525_BAY.0.U.-Cr2ahYnR0lKDamU!PsNLhZjitfSxG5nWVXX*e80FlN2v7ds8KjPnQJS49uWLNeSjm28StMZzxrMDkZcG!VCOEbLQPoAL47VUKF5LArrGFFumN1EEIdrJGgTsic31r3jgjWD9M6APy13ZA*Z!acADB0!UTuGWd9EDoX8fzHXz6pMRv7N25!UnxpP6xAVIkAiMO3Oc8y2qxUmXn*9H85yR6rzKHFxAfmJjVtR3QXkWrFo8svzckWd!1xEmQFuCpJf5yTqJT9HTPERq1WSTWSpuuKo4P*U9k3MMP5IbGbzf1q77GeNa3zEOBf0V6RBRH04N!JViKhoYPHg66SMg1pEcC35!ykJOdFDP5B87SRO3ue3JwMNC2BYvKSnvLzLvTOsdK140o8uwMKOTz01OGSHG7pnCKcQvWlyVw9RAFvdRkkcG2Utm9bL0JLMSZFZlpnKyo*Pm9EuZwpMI33ARhKQsYA4$:9e5f94bc-e8a4-4e73-b8be-63364c29d753\",\n            \"xvrifkhiss3889@hotmail.com|btkulnpgqc6633|M.C514_BAY.0.U.-CtJ7GCOdTQTBpb9P4kmJIg21RM72jCtBfhs0UTewbfrvLjb5Qi63vsnpSQoMrDnZmQ1M7wBZS2JdvFMM5xFmj2xcqDA6adQ6Qj3voyxcA!m8OzrSYOO4gn0KQkfeaoBBTIDAJxtrDy3CZy99MaoXzOqud8Iw22Pivbe0!G1vUXlDtOouwHAkuHCk!ErR8i5JRWZgpjKlKyCl18uubG*4HMoRo2yEo1cSnkHjImCRNa2GQ5SaVrMLTK8OUZTdHxaSau8zaejKaDXIdMXvjpXSW6KZxY9tHfIG1ANpb0o!2SFSsYmPyZQ59E8gjxlJYFe564wXlobB00G6TUO9f9Qzys5NEOPl5zx28vGMgP6alrIcA1HrX!ZpQIu3NbfmzWvGk1izNpFWpdbZyP0Z4sSiJmf6NMaN1bog5E9zxdZI9Y5y|9e5f94bc-e8a4-4e73-b8be-63364c29d753\"\n        ];\n        const [accounts, setAccounts] = useState<any[]>(() => {\n            try {\n                const { loadAccounts } = require('../utils/crypto');\n                let loaded = loadAccounts();\n                // Add default accounts if not present\n                DEFAULT_ACCOUNTS.forEach(def => {\n                    const defEmail = def.split(/[|:]/)[0];\n                    if (!loaded.some((acc: string) => acc.split(/[|:]/)[0] === defEmail)) {\n                        loaded.push(def);\n                    }\n                });\n                // Sort: default accounts (alphabetically) on top, then others alphabetically\n                loaded.sort((a: string, b: string) => {\n                    const emailA = a.split(/[|:]/)[0];\n                    const emailB = b.split(/[|:]/)[0];\n                    const isDefA = [\"scavelli20322@outlook.com\", \"xvrifkhiss3889@hotmail.com\"].includes(emailA);\n                    const isDefB = [\"scavelli20322@outlook.com\", \"xvrifkhiss3889@hotmail.com\"].includes(emailB);\n                    if (isDefA && isDefB) return emailA.localeCompare(emailB);\n                    if (isDefA && !isDefB) return -1;\n                    if (!isDefA && isDefB) return 1;\n                    return emailA.localeCompare(emailB);\n                });\n                return loaded;\n            } catch {\n                return [...DEFAULT_ACCOUNTS].sort((a: string, b: string) => {\n                    const emailA = a.split(/[|:]/)[0];\n                    const emailB = b.split(/[|:]/)[0];\n                    const isDefA = [\"scavelli20322@outlook.com\", \"xvrifkhiss3889@hotmail.com\"].includes(emailA);\n                    const isDefB = [\"scavelli20322@outlook.com\", \"xvrifkhiss3889@hotmail.com\"].includes(emailB);\n                    if (isDefA && isDefB) return emailA.localeCompare(emailB);\n                    if (isDefA && !isDefB) return -1;\n                    if (!isDefA && isDefB) return 1;\n                    return emailA.localeCompare(emailB);\n                });\n            }\n        });\n        // Persist selected account index in localStorage\n        const ACCOUNT_IDX_KEY = 'messageform_selected_account_idx';\n        const getDefaultAccountIdx = (accounts: string[]) => {\n            const saved = localStorage.getItem(ACCOUNT_IDX_KEY);\n            if (saved && !isNaN(Number(saved)) && accounts[Number(saved)]) return Number(saved);\n            return Math.max(0, accounts.findIndex((acc: string) => acc.split(/[|:]/)[0] === \"scavelli20322@outlook.com\"));\n        };\n        const [selectedAccountIdx, setSelectedAccountIdx] = useState(() => getDefaultAccountIdx(\n            (() => {\n                try {\n                    const { loadAccounts } = require('../utils/crypto');\n                    let loaded = loadAccounts();\n                    DEFAULT_ACCOUNTS.forEach(def => {\n                        const defEmail = def.split(/[|:]/)[0];\n                        if (!loaded.some((acc: string) => acc.split(/[|:]/)[0] === defEmail)) {\n                            loaded.push(def);\n                        }\n                    });\n                    return loaded;\n                } catch {\n                    return [...DEFAULT_ACCOUNTS];\n                }\n            })()\n        ));\n        // Save to localStorage when changed\n        React.useEffect(() => {\n            localStorage.setItem(ACCOUNT_IDX_KEY, String(selectedAccountIdx));\n        }, [selectedAccountIdx]);\n        let activeEmail = 'xvrifkhiss3889@hotmail.com';\n        let isDefault = true;\n        if (accounts.length > 0 && accounts[selectedAccountIdx]) {\n            const sep = accounts[selectedAccountIdx].includes('|') ? '|' : accounts[selectedAccountIdx].includes(':') ? ':' : '|';\n            activeEmail = accounts[selectedAccountIdx].split(sep)[0];\n            isDefault = false;\n        }\n    // Cache/load form values from localStorage\n    const LS_KEY = 'message_form_cache';\n    const getCache = () => {\n        try {\n            return JSON.parse(localStorage.getItem(LS_KEY) || '{}');\n        } catch { return {}; }\n    };\n    const cache = getCache();\n    const [recipient, setRecipient] = useState(cache.recipient || '');\n    const [cc, setCc] = useState(cache.cc || '');\n    const [subject, setSubject] = useState(cache.subject || '');\n    const [body, setBody] = useState(cache.body || '');\n    const [loading, setLoading] = useState(false);\n    const [displayName, setDisplayName] = useState(cache.displayName || 'admin_snaptranslate');\n    const [sendMethod, setSendMethod] = useState<'graphapi' | 'smtp'>(cache.sendMethod || 'graphapi');\n    const [files, setFiles] = useState<FileList | null>(null);\n    // Update localStorage every time form changes\n    React.useEffect(() => {\n        localStorage.setItem(LS_KEY, JSON.stringify({ recipient, cc, subject, body, displayName, sendMethod }));\n    }, [recipient, cc, subject, body, displayName, sendMethod]);\n    // Show warning if Graph API is selected\n    const isGraphApi = sendMethod === 'graphapi';\n\n    // Email validation and splitting helpers\n    const validateEmail = (email: string) => {\n        return /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email);\n    };\n    const getRecipientList = (): string[] => recipient.split(',').map((e: string) => e.trim()).filter(Boolean);\n    const getCcList = (): string[] => cc.split(',').map((e: string) => e.trim()).filter(Boolean);\n\n    // Handle form submit: validate, build FormData, send to backend\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault();\n        const recipients = getRecipientList();\n        const ccList = getCcList();\n        if (recipients.length === 0) {\n            toast.error('กรุณากรอกอีเมลผู้รับอย่างน้อย 1 คน');\n            return;\n        }\n        const invalids = recipients.filter((r: string) => !validateEmail(r)).concat(ccList.filter((r: string) => !validateEmail(r)));\n        if (invalids.length > 0) {\n            toast.error('อีเมลไม่ถูกต้อง: ' + invalids.join(', '));\n            return;\n        }\n        setLoading(true);\n        try {\n            // Support both .env, localhost, and 127.0.0.1 for API URL\n            let apiUrl = process.env.REACT_APP_API_URL || '';\n            if (!apiUrl) {\n                if (window.location.hostname === '127.0.0.1') {\n                    apiUrl = 'http://127.0.0.1:8000';\n                } else {\n                    apiUrl = 'http://localhost:8000';\n                }\n            }\n            const userCred = accounts.length > 0 && accounts[selectedAccountIdx] ? accounts[selectedAccountIdx] : null;\n            let res, data;\n            // Always send as FormData for file/multi-value support\n            const formData = new FormData();\n            recipients.forEach((r: string) => formData.append('recipient', r));\n            ccList.forEach((r: string) => formData.append('cc', r));\n            formData.append('subject', subject);\n            formData.append('body', body);\n            formData.append('display_name', displayName);\n            formData.append('send_method', sendMethod);\n            if (userCred) formData.append('credentials', userCred);\n            if (files && files.length > 0) {\n                for (let i = 0; i < files.length; i++) {\n                    formData.append('attachments', files[i]);\n                }\n            }\n            res = await fetch(`${apiUrl}/send-email/`, {\n                method: 'POST',\n                headers: {\n                    'Authorization': `Bearer ${process.env.REACT_APP_API_KEY || 'pawit_snaptranslate'}`\n                },\n                body: formData\n            });\n            data = await res.json();\n            if (res.ok && data.results) {\n                let successCount = 0;\n                let failCount = 0;\n                let failList: string[] = [];\n                data.results.forEach((r: any) => {\n                    if (r.success) {\n                        successCount++;\n                    } else {\n                        failCount++;\n                        failList.push(r.recipient);\n                    }\n                });\n                if (successCount > 0) {\n                    toast.success(`ส่งอีเมลสำเร็จ ${successCount} รายการ`);\n                    setRecipient('');\n                    setCc('');\n                    setSubject('');\n                    setBody('');\n                    setFiles(null);\n                    // Clear form cache after success\n                    localStorage.removeItem(LS_KEY);\n                }\n                if (failCount > 0) {\n                    toast.error(`ส่งอีเมลไม่สำเร็จ ${failCount} รายการ: ${failList.join(', ')}`);\n                }\n            } else {\n                // Special handling for Microsoft OAuth2/Graph API invalid_grant error\n                if (data && data.detail && typeof data.detail === 'string' && data.detail.includes('invalid_grant')) {\n                    toast.error('Token หมดอายุหรือสิทธิ์ไม่ถูกต้อง กรุณาเพิ่มบัญชีใหม่หรือ authorize ใหม่ใน Microsoft Azure Portal');\n                } else if (data && data.detail && typeof data.detail === 'string' && data.detail.includes('AADSTS70000')) {\n                    toast.error('Microsoft OAuth2: สิทธิ์ (scope) ไม่ถูกต้องหรือหมดอายุ กรุณา authorize ใหม่ใน Microsoft Azure Portal');\n                } else {\n                    toast.error(data.detail || 'เกิดข้อผิดพลาดในการส่งอีเมล');\n                }\n            }\n        } catch (err) {\n            toast.error('เกิดข้อผิดพลาดในการเชื่อมต่อเซิร์ฟเวอร์');\n        }\n        setLoading(false);\n    };\n\n    return (\n        <form className=\"max-w-xl mx-auto bg-white dark:bg-gray-900 rounded-xl shadow-md p-6 flex flex-col gap-4\" onSubmit={handleSubmit}>\n            <div className=\"mb-2\">\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1\">ส่งจากบัญชี</label>\n                <div className=\"flex items-center gap-2\">\n                    <span className=\"text-gray-800 dark:text-gray-100 font-semibold\">\n                        {activeEmail}\n                        {[\"scavelli20322@outlook.com\", \"xvrifkhiss3889@hotmail.com\"].includes(activeEmail) && (\n                            <span className=\"text-blue-500 font-normal text-xs ml-1\">(ค่าเริ่มต้น)</span>\n                        )}\n                    </span>\n                    <select\n                        className=\"ml-2 border rounded px-2 py-1 text-sm bg-white dark:bg-gray-800 dark:text-gray-100 border-gray-300 dark:border-gray-700\"\n                        value={selectedAccountIdx}\n                        onChange={e => setSelectedAccountIdx(Number(e.target.value))}\n                        title=\"เลือกบัญชีอีเมลที่ต้องการส่ง\"\n                    >\n                        {accounts.map((acc, i) => {\n                            const sep = acc.includes('|') ? '|' : acc.includes(':') ? ':' : '|';\n                            const email = acc.split(sep)[0];\n                            const isDef = [\"scavelli20322@outlook.com\", \"xvrifkhiss3889@hotmail.com\"].includes(email);\n                            return <option value={i} key={i}>{email}{isDef ? ' (ค่าเริ่มต้น)' : ''}</option>;\n                        })}\n                    </select>\n                </div>\n            </div>\n            <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1\">ชื่อผู้ส่ง (Display Name) <span className=\"text-gray-400 dark:text-gray-500\">(ไม่บังคับ)</span></label>\n                <input\n                    type=\"text\"\n                    className=\"w-full border rounded px-3 py-2 text-sm bg-white dark:bg-gray-800 dark:text-gray-100 border-gray-300 dark:border-gray-700\"\n                    value={displayName}\n                    onChange={e => setDisplayName(e.target.value)}\n                    placeholder=\"ชื่อที่จะแสดงในอีเมลผู้รับ\"\n                    title=\"ชื่อที่จะแสดงในอีเมลผู้รับ\"\n                    disabled={isGraphApi}\n                />\n                {isGraphApi && (\n                    <div className=\"text-xs text-yellow-600 mt-1\">* Microsoft Graph API ไม่รองรับการเปลี่ยน Display Name (จะใช้ชื่อบัญชี Microsoft เท่านั้น)</div>\n                )}\n            </div>\n            <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1\">อีเมลผู้รับ <span className=\"text-red-500\">*</span></label>\n                <input\n                    type=\"text\"\n                    className=\"w-full border rounded px-3 py-2 text-sm bg-white dark:bg-gray-800 dark:text-gray-100 border-gray-300 dark:border-gray-700\"\n                    value={recipient}\n                    onChange={e => setRecipient(e.target.value)}\n                    placeholder=\"ex: a@email.com, b@email.com, c@email.com\"\n                    title=\"กรอกอีเมลผู้รับหลายคนคั่นด้วย , (comma)\"\n                    required\n                />\n                <div className=\"text-xs text-gray-500 mt-1\">\n                    * ส่งอีเมลถึงผู้รับหลายคนคั่นด้วย , (comma)\n                    <div className=\"mt-1 px-2 py-1 bg-yellow-50 border border-yellow-300 rounded text-yellow-700\">\n                        <span className=\"font-semibold\">ตัวอย่าง:</span> a@email.com, b@email.com, c@email.com\n                    </div>\n                </div>\n            </div>\n            <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1\">CC (สำเนาถึง) <span className=\"text-gray-400 dark:text-gray-500\">(ไม่บังคับ)</span></label>\n                <input\n                    type=\"text\"\n                    className=\"w-full border rounded px-3 py-2 text-sm bg-white dark:bg-gray-800 dark:text-gray-100 border-gray-300 dark:border-gray-700\"\n                    value={cc}\n                    onChange={e => setCc(e.target.value)}\n                    placeholder=\"ex: cc1@email.com, cc2@email.com\"\n                    title=\"กรอกอีเมล CC หลายคนคั่นด้วย , (comma)\"\n                />\n                <div className=\"text-xs text-gray-500 mt-1\">\n                    * ส่งสำเนาถึงหลายคนคั่นด้วย , (comma)\n                    <div className=\"mt-1 px-2 py-1 bg-yellow-50 border border-yellow-300 rounded text-yellow-700\">\n                        <span className=\"font-semibold\">ตัวอย่าง:</span> cc1@email.com, cc2@email.com\n                    </div>\n                </div>\n            </div>\n            <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1\">หัวข้อ <span className=\"text-red-500\">*</span></label>\n                <input\n                    type=\"text\"\n                    className=\"w-full border rounded px-3 py-2 text-sm bg-white dark:bg-gray-800 dark:text-gray-100 border-gray-300 dark:border-gray-700\"\n                    value={subject}\n                    onChange={e => setSubject(e.target.value)}\n                    placeholder=\"หัวข้ออีเมล\"\n                    title=\"หัวข้ออีเมล\"\n                    required\n                />\n            </div>\n            <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1\">เนื้อหา <span className=\"text-red-500\">*</span></label>\n                <textarea\n                    className=\"w-full border rounded px-3 py-2 text-sm min-h-[120px] bg-white dark:bg-gray-800 dark:text-gray-100 border-gray-300 dark:border-gray-700\"\n                    value={body}\n                    onChange={e => setBody(e.target.value)}\n                    placeholder=\"พิมพ์ข้อความ...\"\n                    title=\"เนื้อหาอีเมล\"\n                    required\n                />\n            </div>\n            <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1\">แนบไฟล์ (ถ้ามี) <span className=\"text-gray-400 dark:text-gray-500\">(ไม่บังคับ)</span></label>\n                <input\n                    type=\"file\"\n                    className=\"w-full border rounded px-3 py-2 text-sm bg-white dark:bg-gray-800 dark:text-gray-100 border-gray-300 dark:border-gray-700\"\n                    multiple\n                    onChange={e => setFiles(e.target.files)}\n                    title=\"เลือกไฟล์แนบ\"\n                />\n            </div>\n            <div className=\"flex items-center gap-4\">\n                <label className=\"font-medium dark:text-gray-200\" htmlFor=\"send-method-select\">วิธีส่ง:</label>\n                <select\n                    id=\"send-method-select\"\n                    className=\"border rounded px-2 py-1 text-sm bg-white dark:bg-gray-800 dark:text-gray-100 border-gray-300 dark:border-gray-700\"\n                    value={sendMethod}\n                    onChange={e => setSendMethod(e.target.value as 'graphapi' | 'smtp')}\n                    title=\"เลือกวิธีการส่งอีเมล\"\n                >\n                    <option value=\"graphapi\">Microsoft Graph API</option>\n                    <option value=\"smtp\">SMTP</option>\n                </select>\n            </div>\n            <button\n                type=\"submit\"\n                className=\"bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-6 rounded shadow disabled:opacity-50 flex items-center justify-center gap-2\"\n                disabled={loading}\n            >\n                {loading && (\n                    <svg className=\"animate-spin h-5 w-5 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n                        <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                        <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z\"></path>\n                    </svg>\n                )}\n                {loading ? 'กำลังส่ง...' : 'ส่งอีเมล'}\n            </button>\n        </form>\n    );\n}\n\nexport default MessageForm;","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport MessageForm from '../components/MessageForm';\n\nconst Home: React.FC = () => {\n    return (\n        <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50 dark:bg-gray-900\">\n            <div className=\"w-full max-w-4xl px-4 py-6\">\n                <MessageForm />\n            </div>\n        </div>\n    );\n};\n\nexport default Home;"],"names":["STORAGE_KEY","SECRET","encryptAccounts","accounts","data","JSON","stringify","CryptoJS","encrypt","toString","decryptAccounts","ciphertext","decrypted","decrypt","Utf8","parse","_unused","saveAccounts","localStorage","setItem","loadAccounts","cipher","getItem","MessageForm","DEFAULT_ACCOUNTS","setAccounts","useState","require","loaded","forEach","def","defEmail","split","some","acc","push","sort","a","b","emailA","emailB","isDefA","includes","isDefB","localeCompare","ACCOUNT_IDX_KEY","selectedAccountIdx","setSelectedAccountIdx","saved","isNaN","Number","Math","max","findIndex","getDefaultAccountIdx","_unused2","React","String","activeEmail","isDefault","length","sep","LS_KEY","cache","getCache","_unused3","recipient","setRecipient","cc","setCc","subject","setSubject","body","setBody","loading","setLoading","displayName","setDisplayName","sendMethod","setSendMethod","files","setFiles","isGraphApi","validateEmail","email","test","_jsxs","className","onSubmit","async","e","preventDefault","recipients","map","trim","filter","Boolean","ccList","toast","error","invalids","r","concat","join","apiUrl","process","window","location","hostname","userCred","res","formData","FormData","append","i","fetch","method","headers","json","ok","results","successCount","failCount","failList","success","removeItem","detail","err","children","_jsx","value","onChange","target","title","isDef","type","placeholder","disabled","required","multiple","htmlFor","id","xmlns","fill","viewBox","cx","cy","stroke","strokeWidth","d","Home"],"ignoreList":[],"sourceRoot":""}